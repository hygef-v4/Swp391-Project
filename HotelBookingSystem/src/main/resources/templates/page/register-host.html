<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head>
    <title>ƒêƒÉng K√Ω Kh√°ch S·∫°n C·ªßa B·∫°n - Booking</title>

    <!-- Meta Tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="author" content="StackBros">
    <meta name="description" content="ƒêƒÉng k√Ω kh√°ch s·∫°n c·ªßa b·∫°n v√† b·∫Øt ƒë·∫ßu cho thu√™ ph√≤ng tr√™n Booking.">

    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
          integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
          crossorigin=""/>

    <!-- Dark mode -->
    <script>
        const storedTheme = localStorage.getItem('theme')

        const getPreferredTheme = () => {
            if (storedTheme) {
                return storedTheme
            }
            return window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light'
        }

        const setTheme = function (theme) {
            if (theme === 'auto' && window.matchMedia('(prefers-color-scheme: dark)').matches) {
                document.documentElement.setAttribute('data-bs-theme', 'dark')
            } else {
                document.documentElement.setAttribute('data-bs-theme', theme)
            }
        }

        setTheme(getPreferredTheme())

        window.addEventListener('DOMContentLoaded', () => {
            var el = document.querySelector('.theme-icon-active');
            if (el != 'undefined' && el != null) {
                const showActiveTheme = theme => {
                    const activeThemeIcon = document.querySelector('.theme-icon-active use')
                    const btnToActive = document.querySelector(`[data-bs-theme-value="${theme}"]`)
                    const svgOfActiveBtn = btnToActive.querySelector('.mode-switch use').getAttribute('href')

                    document.querySelectorAll('[data-bs-theme-value]').forEach(element => {
                        element.classList.remove('active')
                    })

                    btnToActive.classList.add('active')
                    activeThemeIcon.setAttribute('href', svgOfActiveBtn)
                }

                window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', () => {
                    if (storedTheme !== 'light' || storedTheme !== 'dark') {
                        setTheme(getPreferredTheme())
                    }
                })

                showActiveTheme(getPreferredTheme())

                document.querySelectorAll('[data-bs-theme-value]')
                    .forEach(toggle => {
                        toggle.addEventListener('click', () => {
                            const theme = toggle.getAttribute('data-bs-theme-value')
                            localStorage.setItem('theme', theme)
                            setTheme(theme)
                            showActiveTheme(theme)
                        })
                    })

            }
        })

    </script>

    <!-- Favicon -->
    <link rel="shortcut icon" href="assets/images/favicon.ico">

    <!-- Google Font -->
    <link rel="preconnect" href="https://fonts.googleapis.com/">
    <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin>
    <link rel="stylesheet"
          href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;700&family=Poppins:wght@400;500;700&display=swap">

    <!-- Plugins CSS -->
    <link rel="stylesheet" type="text/css" href="assets/vendor/font-awesome/css/all.min.css">
    <link rel="stylesheet" type="text/css" href="assets/vendor/bootstrap-icons/bootstrap-icons.css">
    <link rel="stylesheet" type="text/css" href="assets/vendor/choices/css/choices.min.css">
    <link rel="stylesheet" type="text/css" href="assets/vendor/stepper/css/bs-stepper.min.css">
    <link rel="stylesheet" type="text/css" href="assets/vendor/quill/css/quill.snow.css">
    <link rel="stylesheet" type="text/css" href="assets/vendor/dropzone/css/dropzone.css">


    <!-- Theme CSS -->
    <link rel="stylesheet" type="text/css" href="assets/css/style.css">
    <style>
        /* Ensure map has a height */
        #hotelLocationMap {
            height: 350px; /* You can adjust this height */
            width: 100%;
            border: 1px solid #ddd;
            border-radius: 0.25rem;
        }
    </style>
</head>

<body>

<!-- Header START -->
<div th:replace="~{common/header :: header}"></div>
<!-- Header END -->

<!-- **************** MAIN CONTENT START **************** -->
<main>

    <!-- =======================
    Page Banner START -->
    <section class="pt-4 pt-md-5 pb-0">
        <div class="container">
            <div class="row">
                <div class="col-12 text-center">
                    <h1 class="fs-2 mb-2">ƒêƒÉng K√Ω Kh√°ch S·∫°n C·ªßa B·∫°n</h1>
                    <p class="mb-0">Chia s·∫ª th√¥ng tin kh√°ch s·∫°n c·ªßa b·∫°n v√† b·∫Øt ƒë·∫ßu ti·∫øp c·∫≠n h√†ng tri·ªáu kh√°ch h√†ng. Ch√∫ng
                        t√¥i s·∫Ω h∆∞·ªõng d·∫´n b·∫°n qua t·ª´ng b∆∞·ªõc.</p>
                </div>
            </div>
        </div>
    </section>
    <!-- =======================
    Page Banner END -->

    <!-- =======================
    Steps START -->
    <section>
        <div class="container">
            <div id="hostStepper" class="bs-stepper stepper-outline">
                <!-- Step Buttons START -->
                <div class="bs-stepper-header" role="tablist">
                    <!-- Step 1 -->
                    <div class="step" data-target="#step-hotel-1">
                        <div class="text-center">
                            <button type="button" class="btn btn-link step-trigger mb-0" role="tab"
                                    id="stepperHotelTrigger1" aria-controls="step-hotel-1">
                                <span class="bs-stepper-circle">1</span>
                            </button>
                            <h6 class="bs-stepper-label d-none d-md-block">Th√¥ng Tin Kh√°ch S·∫°n</h6>
                        </div>
                    </div>
                    <div class="line"></div>

                    <!-- Step 2 -->
                    <div class="step" data-target="#step-hotel-2">
                        <div class="text-center">
                            <button type="button" class="btn btn-link step-trigger mb-0" role="tab"
                                    id="stepperHotelTrigger2" aria-controls="step-hotel-2">
                                <span class="bs-stepper-circle">2</span>
                            </button>
                            <h6 class="bs-stepper-label d-none d-md-block">Chi Ti·∫øt Lo·∫°i Ph√≤ng C∆° B·∫£n</h6>
                        </div>
                    </div>
                    <div class="line"></div>

                    <!-- Step 3 -->
                    <div class="step" data-target="#step-hotel-3">
                        <div class="text-center">
                            <button type="button" class="btn btn-link step-trigger mb-0" role="tab"
                                    id="stepperHotelTrigger3" aria-controls="step-hotel-3">
                                <span class="bs-stepper-circle">3</span>
                            </button>
                            <h6 class="bs-stepper-label d-none d-md-block">Ch√≠nh S√°ch & ƒêƒÉng K√Ω</h6>
                        </div>
                    </div>
                </div>
                <!-- Step Buttons END -->

                <!-- Step content START -->
                <div class="bs-stepper-content p-0 pt-4 pt-md-5">
                    <form onsubmit="return false">

                        <!-- Step 1 content START: Hotel Information -->
                        <div id="step-hotel-1" role="tabpanel" class="content fade"
                             aria-labelledby="stepperHotelTrigger1">
                            <div class="vstack gap-4">
                                <h4 class="mb-0">Cung c·∫•p th√¥ng tin v·ªÅ kh√°ch s·∫°n c·ªßa b·∫°n</h4>

                                <!-- Hotel Basic Information -->
                                <div class="card shadow">
                                    <div class="card-header border-bottom">
                                        <h5 class="mb-0">Th√¥ng Tin C∆° B·∫£n Kh√°ch S·∫°n</h5>
                                    </div>
                                    <div class="card-body">
                                        <div class="col-12 mb-3">
                                            <label class="form-label">T√™n kh√°ch s·∫°n c·ªßa b·∫°n *</label>
                                            <input class="form-control" type="text"
                                                   placeholder="V√≠ d·ª•: Kh√°ch S·∫°n Sen V√†ng" id="hotelName">
                                            <small>T√™n s·∫Ω hi·ªÉn th·ªã cho kh√°ch h√†ng.</small>
                                        </div>
                                        <div class="col-12 mb-3">
                                            <label class="form-label">M√¥ t·∫£ v·ªÅ kh√°ch s·∫°n c·ªßa b·∫°n *</label>
                                            <div class="bg-light border border-bottom-0 rounded-top py-3 quilltoolbar">
                                                <span class="ql-formats"><select class="ql-size"></select></span>
                                                <span class="ql-formats"><button class="ql-bold"></button><button
                                                        class="ql-italic"></button><button
                                                        class="ql-underline"></button></span>
                                                <span class="ql-formats"><button class="ql-list"
                                                                                 value="ordered"></button><button
                                                        class="ql-list" value="bullet"></button></span>
                                                <span class="ql-formats"><button class="ql-link"></button></span>
                                                <span class="ql-formats"><button class="ql-clean"></button></span>
                                            </div>
                                            <div class="bg-body border rounded-bottom h-200px overflow-hidden quilleditor"
                                                 id="hotelDescriptionEditor">
                                                <p>N√™u b·∫≠t nh·ªØng ƒëi·ªÉm ƒë·ªôc ƒë√°o, ti·ªán nghi chung, v√† kh√¥ng kh√≠ c·ªßa kh√°ch
                                                    s·∫°n.</p>
                                            </div>
                                        </div>
                                        <div class="col-12">
                                            <label class="form-label">·∫¢nh ƒë·∫°i di·ªán kh√°ch s·∫°n *</label>
                                            <div class="dropzone dropzone-custom"
                                                 data-dropzone='{"maxFiles": 1, "addRemoveLinks": true, "acceptedFiles": "image/*"}'
                                                 id="hotelMainImage">
                                                <div class="dz-message needsclick">
                                                    <i class="bi bi-image-fill display-3"></i>
                                                    <p>K√©o th·∫£ m·ªôt ·∫£nh ho·∫∑c nh·∫•p ƒë·ªÉ t·∫£i l√™n.</p>
                                                </div>
                                            </div>
                                            <div class="mb-3">
                                                <label for="hotelImageUpload" class="form-label">Ho·∫∑c ch·ªçn ·∫£nh t·ª´ m√°y
                                                    t√≠nh c·ªßa b·∫°n</label>
                                                <input class="form-control" type="file" id="hotelImageUpload"
                                                       accept="image/*">
                                                <small class="form-text text-muted">Ch·ªçn ·∫£nh JPG/PNG t·ª´ thi·∫øt
                                                    b·ªã.</small>
                                            </div>

                                            <small>·∫¢nh n√†y s·∫Ω l√† ·∫£nh ch√≠nh cho kh√°ch s·∫°n c·ªßa b·∫°n.</small>
                                        </div>
                                    </div>
                                </div>

                                <!-- Hotel Location -->
                                <!-- Hotel Location -->
                                <!-- Hotel Location -->
                                <div class="card shadow">
                                    <div class="card-header border-bottom">
                                        <h5 class="mb-0">V·ªã Tr√≠ Kh√°ch S·∫°n</h5>
                                    </div>
                                    <div class="card-body">
                                        <div class="row g-3">
                                            <div class="col-12">
                                                <label class="form-label" for="hotelAddress">ƒê·ªãa ch·ªâ kh√°ch s·∫°n *</label>
                                                <input class="form-control" type="text"
                                                       placeholder="V√≠ d·ª•: 123 ƒê∆∞·ªùng ABC, Ph∆∞·ªùng XYZ, Qu·∫≠n 1"
                                                       id="hotelAddress">
                                                <small>ƒê·ªãa ch·ªâ ch√≠nh x√°c s·∫Ω gi√∫p kh√°ch h√†ng t√¨m th·∫•y b·∫°n. Nh·∫≠p ƒë·ªãa ch·ªâ
                                                    c√≥ th·ªÉ gi√∫p ƒë·ªãnh v·ªã b·∫£n ƒë·ªì.</small>
                                            </div>

                                            <!-- Inside the <form> in step-hotel-1, for example, near the city input -->


                                            <!-- New Location Dropdown -->
                                            <div class="col-md">
                                                <label class="form-label" for="hotelLocation">Khu v·ª±c/ƒê·ªãa ƒëi·ªÉm *</label>
                                                <select class="form-select js-choice" id="hotelLocation"
                                                        name="hotelLocationId" data-search-enabled="true">
                                                    <option value="">Ch·ªçn ƒë·ªãa ƒëi·ªÉm</option>
                                                    <!--/* Iterate over locations from the model */-->
                                                    <th:block th:each="location : ${session.locations}">
                                                        <option th:value="${location.id}"
                                                                th:text="${location.cityName}">Location Name
                                                        </option>
                                                    </th:block>
                                                </select>
                                            </div>

                                            <!--                                            <div class="col-md-6">-->
                                            <!--                                                <label class="form-label" for="hotelCountry">Qu·ªëc gia *</label>-->
                                            <!--                                                <select class="form-select js-choice" id="hotelCountry">-->
                                            <!--                                                    <option value="">Ch·ªçn Qu·ªëc gia</option>-->
                                            <!--                                                    <option selected value="Vi·ªát Nam">Vi·ªát Nam</option>-->
                                            <!--                                                    <option value="Hoa K·ª≥">Hoa K·ª≥</option>-->
                                            <!--                                                    <option value="Th√°i Lan">Th√°i Lan</option>-->
                                            <!--                                                    <option value="Nh·∫≠t B·∫£n">Nh·∫≠t B·∫£n</option>-->
                                            <!--                                                </select>-->
                                            <!--                                            </div>-->

                                            <!-- Interactive Map Integration START -->
                                            <div class="col-12 mt-3">
                                                <label class="form-label">Ch·ªçn v·ªã tr√≠ tr√™n b·∫£n ƒë·ªì ho·∫∑c nh·∫≠p t·ªça ƒë·ªô th·ªß
                                                    c√¥ng:</label>
                                                <div id="interactiveHotelMap"
                                                     style="height: 300px; width: 100%; border: 1px solid #ddd; border-radius: 0.25rem;">
                                                    <!-- Map will be initialized here by Leaflet -->
                                                </div>
                                                <small class="form-text text-muted">K√©o th·∫£ ghim ho·∫∑c nh·∫•p v√†o b·∫£n ƒë·ªì ƒë·ªÉ
                                                    ch·ªçn v·ªã tr√≠. T·ªça ƒë·ªô s·∫Ω t·ª± ƒë·ªông c·∫≠p nh·∫≠t b√™n d∆∞·ªõi.</small>
                                            </div>
                                            <!-- Interactive Map Integration END -->

                                            <!-- Manual Latitude and Longitude Input START -->
                                            <div class="col-md-6 mt-2">
                                                <label for="hotelLatitudeManual" class="form-label">Vƒ© ƒë·ªô
                                                    (Latitude)</label>
                                                <input type="text" class="form-control" id="hotelLatitudeManual"
                                                       name="hotelLatitudeManual" placeholder="V√≠ d·ª•: 21.028511">
                                            </div>
                                            <div class="col-md-6 mt-2">
                                                <label for="hotelLongitudeManual" class="form-label">Kinh ƒë·ªô
                                                    (Longitude)</label>
                                                <input type="text" class="form-control" id="hotelLongitudeManual"
                                                       name="hotelLongitudeManual" placeholder="V√≠ d·ª•: 105.854167">
                                            </div>
                                            <div class="col-12">
                                                <small class="form-text text-muted">
                                                    T·ªça ƒë·ªô s·∫Ω ƒë∆∞·ª£c c·∫≠p nh·∫≠t t·ª´ b·∫£n ƒë·ªì, ho·∫∑c b·∫°n c√≥ th·ªÉ nh·∫≠p th·ªß c√¥ng.
                                                </small>
                                            </div>
                                            <!-- Manual Latitude and Longitude Input END -->
                                        </div>
                                    </div>
                                </div>
                                <div class="text-end">
                                    <button class="btn btn-primary next-btn mb-0">Ti·∫øp Theo</button>
                                </div>
                            </div>
                        </div>
                        <!-- Step 1 content END -->

                        <!-- Step 2 content START: Initial Room Type Details -->
                        <div id="step-hotel-2" role="tabpanel" class="content fade"
                             aria-labelledby="stepperHotelTrigger2">
                            <div class="vstack gap-4">
                                <h4 class="mb-0">Thi·∫øt l·∫≠p lo·∫°i ph√≤ng ƒë·∫ßu ti√™n c·ªßa b·∫°n</h4>
                                <p>B·∫°n c√≥ th·ªÉ th√™m nhi·ªÅu lo·∫°i ph√≤ng kh√°c sau khi kh√°ch s·∫°n ƒë∆∞·ª£c ƒëƒÉng k√Ω.</p>

                                <!-- Room Details -->
                                <div class="card shadow">
                                    <div class="card-header border-bottom">
                                        <h5 class="mb-0">Th√¥ng Tin Lo·∫°i Ph√≤ng</h5>
                                    </div>
                                    <div class="card-body">
                                        <div class="row g-3">
                                            <div class="col-md-6">
                                                <label class="form-label">Lo·∫°i ph√≤ng (H·∫°ng ph√≤ng) *</label>
                                                <select required class="form-select js-choice" id="roomCategory">
                                                    <option value="">Ch·ªçn lo·∫°i ph√≤ng</option>
                                                    <option th:each="type : ${session.roomTypes}"
                                                            th:value="${type.roomTypeId}"
                                                            th:text="${type.name}"
                                                    >

                                                    </option>

                                                </select>
                                            </div>
                                            <div class="col-md-6">
                                                <label class="form-label">T√™n/Ti√™u ƒë·ªÅ ph√≤ng *</label>
                                                <input type="text" class="form-control"
                                                       placeholder="V√≠ d·ª•: Ph√≤ng Standard gi∆∞·ªùng ƒë√¥i h∆∞·ªõng ph·ªë"
                                                       id="roomTitle">
                                            </div>
                                            <div class="col-md-6">
                                                <label class="form-label">S·ªë kh√°ch t·ªëi ƒëa / ph√≤ng *</label>
                                                <input type="number" class="form-control" placeholder="S·ªë l∆∞·ª£ng kh√°ch"
                                                       min="1" id="roomMaxGuests">
                                            </div>
                                            <div class="col-md-6">
                                                <label class="form-label">S·ªë l∆∞·ª£ng ph√≤ng lo·∫°i n√†y *</label>
                                                <input type="number" class="form-control" placeholder="S·ªë l∆∞·ª£ng" min="1"
                                                       id="roomQuantity">
                                            </div>
                                            <div class="col-md-6">
                                                <label class="form-label">Gi√° m·ªói ƒë√™m (VND) *</label>
                                                <input type="number" class="form-control" placeholder="Gi√° ph√≤ng"
                                                       min="0" id="roomPrice">
                                            </div>
                                            <div class="col-12">
                                                <label class="form-label">M√¥ t·∫£ chi ti·∫øt v·ªÅ lo·∫°i ph√≤ng n√†y *</label>
                                                <div class="bg-light border border-bottom-0 rounded-top py-3 quilltoolbar">
                                                    <span class="ql-formats"><select class="ql-size"></select></span>
                                                    <span class="ql-formats"><button class="ql-bold"></button><button
                                                            class="ql-italic"></button><button
                                                            class="ql-underline"></button></span>
                                                    <span class="ql-formats"><button class="ql-list"
                                                                                     value="ordered"></button><button
                                                            class="ql-list" value="bullet"></button></span>
                                                    <span class="ql-formats"><button class="ql-clean"></button></span>
                                                </div>
                                                <div class="bg-body border rounded-bottom h-150px overflow-hidden quilleditor"
                                                     id="roomDescriptionEditor">
                                                    <p>M√¥ t·∫£ v·ªÅ k√≠ch th∆∞·ªõc ph√≤ng, lo·∫°i gi∆∞·ªùng, t·∫ßm nh√¨n, v√† c√°c ƒë·∫∑c ƒëi·ªÉm
                                                        n·ªïi b·∫≠t kh√°c.</p>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Room Amenities -->
                                <div class="card shadow">
                                    <div class="card-header border-bottom">
                                        <h5 class="mb-0">Ti·ªán Nghi Ph√≤ng</h5>
                                    </div>
                                    <div class="card-body">
                                        <label class="form-label mb-3">Ch·ªçn c√°c ti·ªán nghi c√≥ trong lo·∫°i ph√≤ng n√†y:</label>

                                        <!-- Loop through each category -->
                                        <div th:each="entry : ${groupedAmenities}">
                                            <!-- üè∑ Category Name -->
                                            <h6 class="fw-bold mb-2" th:text="${entry.key}">T√™n danh m·ª•c</h6>

                                            <div class="row">
                                                <!-- Amenities under that category -->
                                                <div class="col-sm-6 col-md-4" th:each="amenity : ${entry.value}">
                                                    <div class="form-check mb-2">
                                                        <input class="form-check-input"
                                                               type="checkbox"
                                                               th:id="'amenity-' + ${amenity.amenityId}"
                                                               th:name="amenities"
                                                               th:value="${amenity.amenityId}" />
                                                        <label class="form-check-label"
                                                               th:for="'amenity-' + ${amenity.amenityId}"
                                                               th:text="${amenity.name}"></label>
                                                    </div>
                                                </div>
                                            </div>

                                            <!-- Separator -->
                                            <hr class="my-3" />
                                        </div>
                                    </div>
                                </div>


                                <!-- Room Photos -->
                                <div class="card shadow">
                                    <div class="card-header border-bottom">
                                        <h5 class="mb-0">H√¨nh ·∫¢nh Lo·∫°i Ph√≤ng</h5>
                                    </div>
                                    <div class="card-body">
                                        <label class="form-label">T·∫£i l√™n h√¨nh ·∫£nh cho lo·∫°i ph√≤ng n√†y (√≠t nh·∫•t 3 ·∫£nh)
                                            *</label>

                                        <!-- Dropzone uploader -->
                                        <div class="dropzone dropzone-custom"
                                             data-dropzone='{"maxFiles": 10, "addRemoveLinks": true, "acceptedFiles": "image/*"}'
                                             id="roomImages">
                                            <div class="dz-message needsclick">
                                                <i class="bi bi-images display-3"></i>
                                                <p>K√©o th·∫£ t·ªáp v√†o ƒë√¢y ho·∫∑c nh·∫•p ƒë·ªÉ t·∫£i l√™n.</p>
                                            </div>
                                        </div>

                                        <!-- OR manual file input -->
                                        <div class="mt-3">
                                            <label for="roomImageUpload" class="form-label">Ho·∫∑c ch·ªçn ·∫£nh t·ª´ m√°y t√≠nh
                                                c·ªßa b·∫°n</label>
                                            <input class="form-control" type="file" id="roomImageUpload"
                                                   accept="image/*" multiple>
                                            <small>Ch·ªçn nhi·ªÅu ·∫£nh JPG/PNG t·ª´ thi·∫øt b·ªã c·ªßa b·∫°n.</small>

                                            <!-- Optional preview -->
                                            <div id="roomImagePreviewContainer"
                                                 class="mt-3 d-flex flex-wrap gap-2"></div>
                                        </div>
                                    </div>


                                </div>
                            </div>


                            <div class="hstack gap-2 flex-wrap justify-content-between">
                                <button class="btn btn-secondary prev-btn mb-0">Tr∆∞·ªõc</button>
                                <button class="btn btn-primary next-btn mb-0">Ti·∫øp Theo</button>
                            </div>
                        </div>
                </div>
                <!-- Step 2 content END -->

                <!-- Step 3 content START: Policies & Registration -->
                <div id="step-hotel-3" role="tabpanel" class="content fade" aria-labelledby="stepperHotelTrigger3">
                    <div class="vstack gap-4">
                        <h4 class="mb-0">Ch√≠nh s√°ch kh√°ch s·∫°n v√† ho√†n t·∫•t ƒëƒÉng k√Ω</h4>

                        <!-- Hotel Policies / House Rules -->
                        <div class="card shadow">
                            <div class="card-header border-bottom">
                                <h5 class="mb-0">N·ªôi Quy & Ch√≠nh S√°ch Kh√°ch S·∫°n</h5>
                            </div>
                            <div class="card-body">
                                <label class="form-label">Quy ƒë·ªãnh chung cho kh√°ch (v√≠ d·ª•: gi·ªù nh·∫≠n/tr·∫£ ph√≤ng, ch√≠nh
                                    s√°ch h√∫t thu·ªëc, v·∫≠t nu√¥i, h·ªßy ph√≤ng...)</label>
                                <textarea class="form-control" rows="5"
                                          placeholder="V√≠ d·ª•: Gi·ªù nh·∫≠n ph√≤ng: 14:00, Gi·ªù tr·∫£ ph√≤ng: 12:00. Kh√¥ng h√∫t thu·ªëc trong ph√≤ng. Cho ph√©p v·∫≠t nu√¥i nh·ªè v·ªõi ph·ª• ph√≠..."
                                          id="hotelPolicies"></textarea>
                            </div>
                        </div>

                        <!-- Pricing Discounts (Optional) -->
                        <div class="card shadow">
                            <div class="card-header border-bottom">
                                <h5 class="mb-0">∆Øu ƒê√£i Gi√° (T√πy ch·ªçn)</h5>
                            </div>
                            <div class="card-body">
                                <div class="col-md-8">
                                    <label class="form-label">Gi·∫£m gi√° cho kh√°ch ·ªü d√†i ng√†y</label>
                                    <select class="form-select js-choice" id="longStayDiscount">
                                        <option value="0">Kh√¥ng gi·∫£m gi√°</option>
                                        <option value="10">Gi·∫£m 10% cho 7 ƒë√™m tr·ªü l√™n</option>
                                        <option value="15">Gi·∫£m 15% cho 14 ƒë√™m tr·ªü l√™n</option>
                                        <option value="20">Gi·∫£m 20% cho 30 ƒë√™m tr·ªü l√™n</option>
                                    </select>
                                </div>
                            </div>
                        </div>


                        <!-- Summary Review -->
                        <div class="card shadow">
                            <div class="card-header border-bottom">
                                <h5 class="mb-0">Xem L·∫°i Th√¥ng Tin ƒêƒÉng K√Ω</h5>
                            </div>
                            <div class="card-body">
                                <p>Vui l√≤ng ki·ªÉm tra l·∫°i t·∫•t c·∫£ th√¥ng tin b·∫°n ƒë√£ cung c·∫•p. B·∫°n c√≥ th·ªÉ quay l·∫°i c√°c b∆∞·ªõc
                                    tr∆∞·ªõc ƒë·ªÉ ch·ªânh s·ª≠a n·∫øu c·∫ßn.</p>
                                <ul class="list-group list-group-flush">
                                    <li class="list-group-item"><strong>T√™n kh√°ch s·∫°n:</strong> <span
                                            id="summaryHotelName">[S·∫Ω hi·ªÉn th·ªã ·ªü ƒë√¢y]</span></li>
                                    <li class="list-group-item"><strong>ƒê·ªãa ch·ªâ:</strong> <span
                                            id="summaryHotelAddress">[S·∫Ω hi·ªÉn th·ªã ·ªü ƒë√¢y]</span></li>
                                    <li class="list-group-item"><strong>Th√†nh ph·ªë:</strong> <span id="summaryHotelCity">[S·∫Ω hi·ªÉn th·ªã ·ªü ƒë√¢y]</span>
                                    </li>
                                    <li class="list-group-item"><strong>Vƒ© ƒë·ªô:</strong> <span id="summaryLatitude">[S·∫Ω hi·ªÉn th·ªã ·ªü ƒë√¢y]</span>
                                    </li>
                                    <li class="list-group-item"><strong>Kinh ƒë·ªô:</strong> <span id="summaryLongitude">[S·∫Ω hi·ªÉn th·ªã ·ªü ƒë√¢y]</span>
                                    </li>
                                    <li class="list-group-item"><strong>Lo·∫°i ph√≤ng c∆° b·∫£n:</strong> <span
                                            id="summaryRoomTitle">[S·∫Ω hi·ªÉn th·ªã ·ªü ƒë√¢y]</span></li>
                                    <li class="list-group-item"><strong>Gi√° ph√≤ng c∆° b·∫£n:</strong> <span
                                            id="summaryRoomPrice">[S·∫Ω hi·ªÉn th·ªã ·ªü ƒë√¢y]</span> VND
                                    </li>
                                </ul>
                            </div>
                        </div>

                        <!-- Terms and Conditions -->
                        <div class="card shadow">
                            <div class="card-header border-bottom">
                                <h5 class="mb-0">ƒêi·ªÅu Kho·∫£n & Cam K·∫øt</h5>
                            </div>
                            <div class="card-body">
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" value="" id="agreeTerms" required>
                                    <label class="form-check-label" for="agreeTerms">
                                        T√¥i ƒë·ªìng √Ω v·ªõi <a href="terms-of-service.html" target="_blank">ƒêi·ªÅu kho·∫£n D·ªãch
                                        v·ª•</a> v√† <a href="privacy-policy.html" target="_blank">Ch√≠nh s√°ch B·∫£o m·∫≠t</a>
                                        c·ªßa Booking.
                                    </label>
                                </div>
                                <div class="form-check mt-2">
                                    <input class="form-check-input" type="checkbox" value="" id="hostCommitment"
                                           required>
                                    <label class="form-check-label" for="hostCommitment">
                                        T√¥i cam k·∫øt cung c·∫•p th√¥ng tin ch√≠nh x√°c, d·ªãch v·ª• ch·∫•t l∆∞·ª£ng v√† tu√¢n th·ªß c√°c
                                        ti√™u chu·∫©n c·ªßa Booking.
                                    </label>
                                </div>
                            </div>
                        </div>

                        <div class="hstack gap-2 flex-wrap justify-content-between">
                            <button class="btn btn-secondary prev-btn mb-0">Tr∆∞·ªõc</button>
                            <button type="submit" class="btn btn-success mb-0">G·ª≠i ƒêƒÉng K√Ω Kh√°ch S·∫°n</button>
                        </div>
                    </div>
                </div>
                <!-- Step 3 content END -->

                </form>
            </div>
            <!-- Step content END -->
        </div>
        </div>
    </section>
    <!-- =======================
    Steps END -->

</main>
<!-- **************** MAIN CONTENT END **************** -->

<!-- =======================
Footer START -->
<div th:replace="~{common/footer :: footer}"></div>
<!-- =======================
Footer END -->

<!-- Back to top -->
<div class="back-top"></div>

<!-- Bootstrap JS -->
<script src="assets/vendor/bootstrap/dist/js/bootstrap.bundle.min.js"></script>

<!-- Vendors -->
<script src="assets/vendor/choices/js/choices.min.js"></script>
<script src="assets/vendor/stepper/js/bs-stepper.min.js"></script>
<script src="assets/vendor/quill/js/quill.min.js"></script>
<script src="assets/vendor/dropzone/js/dropzone.js"></script>

<!-- Leaflet JS -->
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
        integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
        crossorigin=""></script>

<!-- ThemeFunctions -->
<script src="assets/js/functions.js"></script>

<script>
    document.addEventListener('DOMContentLoaded', function () {
        var stepperEl = document.querySelector('#hostStepper');
        var stepper;
        var quillHotelDescription, quillRoomDescription; // To store Quill instances

        if (stepperEl) {
            stepper = new Stepper(stepperEl, {
                linear: false,
                animation: true
            });
        }

        // Initialize Quill editors
        var quillEditorElements = document.querySelectorAll('.quilleditor');
        quillEditorElements.forEach(function (editorEl) {
            var toolbar = editorEl.previousElementSibling;
            if (toolbar && toolbar.classList.contains('quilltoolbar')) {
                const quillInstance = new Quill(editorEl, {
                    modules: {
                        toolbar: toolbar
                    },
                    theme: 'snow'
                });
                if (editorEl.id === 'hotelDescriptionEditor') {
                    quillHotelDescription = quillInstance;
                } else if (editorEl.id === 'roomDescriptionEditor') {
                    quillRoomDescription = quillInstance;
                }
            }
        });

        // Initialize Choices.js
        var choiceElements = document.querySelectorAll('.js-choice');
        choiceElements.forEach(function (el) {
            new Choices(el, {
                searchEnabled: false,
                itemSelectText: 'Nh·∫•n ƒë·ªÉ ch·ªçn',
            });
        });

        // --- Leaflet Map Integration ---
        var map;
        var marker;
        const hotelLatInput = document.getElementById('hotelLatitude');
        const hotelLngInput = document.getElementById('hotelLongitude');
        const hotelCityInput = document.getElementById('hotelCity');
        const hotelAddressInput = document.getElementById('hotelAddress');
        var mapInitialized = false; // Flag to check if map is already initialized

        function initializeHotelMap() {
            if (mapInitialized || !document.getElementById('hotelLocationMap')) return;

            // Default coordinates (e.g., Hanoi, Vietnam)
            let defaultLat = 21.0285;
            let defaultLng = 105.8542;
            let defaultZoom = 6; // Zoom out a bit initially for wider country view

            // Use existing values if available (e.g., if user comes back to this step)
            if (hotelLatInput.value && hotelLngInput.value) {
                defaultLat = parseFloat(hotelLatInput.value);
                defaultLng = parseFloat(hotelLngInput.value);
                defaultZoom = 15; // Zoom in if a specific point is already set
            }

            map = L.map('hotelLocationMap').setView([defaultLat, defaultLng], defaultZoom);

            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: '¬© <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
            }).addTo(map);

            marker = L.marker([defaultLat, defaultLng], {
                draggable: true
            }).addTo(map);

            function updateLatLngInputs(latlng) {
                hotelLatInput.value = latlng.lat.toFixed(6);
                hotelLngInput.value = latlng.lng.toFixed(6);
                // console.log("Updated Coords:", hotelLatInput.value, hotelLngInput.value);
            }

            marker.on('dragend', function (event) {
                updateLatLngInputs(marker.getLatLng());
            });

            map.on('click', function (e) {
                marker.setLatLng(e.latlng);
                updateLatLngInputs(e.latlng);
            });

            // Set initial hidden input values if not already set by marker drag/click
            if (!hotelLatInput.value || !hotelLngInput.value) {
                updateLatLngInputs(marker.getLatLng());
            }
            mapInitialized = true;
        }

        // Attempt to geocode address (simple Nominatim example)
        function geocodeAddressAndSetMap() {
            const city = hotelCityInput.value;
            const address = hotelAddressInput.value;
            let query = address;
            if (city && address.toLowerCase().indexOf(city.toLowerCase()) === -1) { // Add city if not already in address
                query += ", " + city;
            }
            query += ", Vi·ªát Nam"; // Assuming Vietnam as default country for better results

            if (!query.trim()) return;

            // Simple check to avoid excessive API calls if address hasn't changed much
            if (map && map.lastGeocodedQuery === query) return;


            fetch(`https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(query)}&limit=1`)
                .then(response => response.json())
                .then(data => {
                    if (data && data.length > 0) {
                        const lat = parseFloat(data[0].lat);
                        const lon = parseFloat(data[0].lon);
                        if (map && marker) {
                            map.setView([lat, lon], 15);
                            marker.setLatLng([lat, lon]);
                            hotelLatInput.value = lat.toFixed(6);
                            hotelLngInput.value = lon.toFixed(6);
                            map.lastGeocodedQuery = query; // Store last geocoded query
                            // console.log("Geocoded and set map to:", lat, lon);
                        }
                    } else {
                        // console.log("Could not geocode address:", query);
                        // Fallback to city if full address fails
                        if (city && city !== query.split(",")[0]) { // Avoid re-querying if city was the main part
                            fetch(`https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(city + ", Vi·ªát Nam")}&limit=1`)
                                .then(response => response.json())
                                .then(cityData => {
                                    if (cityData && cityData.length > 0) {
                                        const lat = parseFloat(cityData[0].lat);
                                        const lon = parseFloat(cityData[0].lon);
                                        if (map && marker) {
                                            map.setView([lat, lon], 13); // Zoom out a bit for city
                                            marker.setLatLng([lat, lon]);
                                            hotelLatInput.value = lat.toFixed(6);
                                            hotelLngInput.value = lon.toFixed(6);
                                            map.lastGeocodedQuery = city + ", Vi·ªát Nam";
                                        }
                                    }
                                });
                        }
                    }
                })
                .catch(error => console.error('Error geocoding:', error));
        }

        if (hotelAddressInput) {
            hotelAddressInput.addEventListener('blur', geocodeAddressAndSetMap);
        }
        if (hotelCityInput) {
            hotelCityInput.addEventListener('blur', geocodeAddressAndSetMap);
        }


        // Stepper event to handle map initialization and resizing
        if (stepperEl) {
            stepperEl.addEventListener('shown.bs-stepper', function (event) {
                if (event.detail.indexStep === 0) { // First step (index 0)
                    if (!mapInitialized) {
                        initializeHotelMap();
                    }
                    if (map) {
                        // Timeout to ensure the div is fully rendered before invalidating size
                        setTimeout(function () {
                            map.invalidateSize();
                        }, 100);
                    }
                }
                // When moving to the review step, update summary
                if (event.detail.indexStep === 2) { // Third step (index 2 for summary)
                    updateSummary();
                }
            });
        }
        // Initialize map if the first step is already active on page load
        if (document.querySelector('#step-hotel-1.active')) {
            initializeHotelMap();
            if (map) {
                setTimeout(function () {
                    map.invalidateSize();
                }, 100);
            }
        }


        // Summary update function
        function updateSummary() {
            document.getElementById('summaryHotelName').textContent = document.getElementById('hotelName')?.value || '[Ch∆∞a nh·∫≠p]';
            document.getElementById('summaryHotelAddress').textContent = document.getElementById('hotelAddress')?.value || '[Ch∆∞a nh·∫≠p]';
            document.getElementById('summaryHotelCity').textContent = document.getElementById('hotelCity')?.value || '[Ch∆∞a nh·∫≠p]';
            document.getElementById('summaryLatitude').textContent = document.getElementById('hotelLatitude')?.value || '[Ch∆∞a ch·ªçn]';
            document.getElementById('summaryLongitude').textContent = document.getElementById('hotelLongitude')?.value || '[Ch∆∞a ch·ªçn]';
            document.getElementById('summaryRoomTitle').textContent = document.getElementById('roomTitle')?.value || '[Ch∆∞a nh·∫≠p]';
            document.getElementById('summaryRoomPrice').textContent = document.getElementById('roomPrice')?.value || '[Ch∆∞a nh·∫≠p]';
        }

        // Update summary when navigating to the last step via next button
        const nextButtons = document.querySelectorAll('.next-btn');
        nextButtons.forEach(button => {
            button.addEventListener('click', function () {
                if (stepper && stepper._currentIndex === 1 && stepper._steps.length === 3) { // If current is step 2 (index 1) and about to go to step 3
                    updateSummary();
                }
            });
        });

        // Also update summary if user directly clicks on the review step tab
        const reviewStepTrigger = document.getElementById('stepperHotelTrigger3');
        if (reviewStepTrigger) {
            reviewStepTrigger.addEventListener('click', updateSummary);
        }

    });
</script>


</body>
</html>